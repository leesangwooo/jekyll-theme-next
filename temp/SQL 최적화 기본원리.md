DBGuide.net.[SQL최적화 기본원리](http://www.dbguide.net/db.db?cmd=view&boardUid=148208&boardConfigUid=9&categoryUid=216&boardIdx=136&boardStep=1)

## 옵티마이저

사용자가 질의한 SQL문에 대해 최적의 실행 방법을 결정하는 역할을 수행

![옵티마이저](http://www.dbguide.net/publishing/img/knowledge/SQL_239.jpg)

1. 규칙기반 옵티마이저
- Oracle의 규칙기반 옵티마이저의 15가지 규칙<br/>
    : 순위가 높을수록(15<1) 최적의 실행 방법
    ![규칙기반 옵티마이저](http://www.dbguide.net/publishing/img/knowledge/SQL_240.jpg)

    - `규칙 1 Single row by rowid` : ROWID를 통해서 테이블에서 하나의 행을 액세스하는 방식이다. ROWID는 행이 포함된 데이터 파일, 블록 등의 정보를 가지고 있기 때문에 다른 정보를 참조하지 않고도 바로 원하는 행을 액세스할 수 있다. 하나의 행을 액세스하는 가장 빠른 방법이다.
    - `규칙 8 Composite index` : 조건절에 포함하는 칼럼의 수가 다수일 때, `규칙 9 Single column index` 와 비교하면, 인덱스 구성 칼럼의 개수가 더 많고, 조건절이 '='으로 주어질수록 우선순위가 높다.
    - `규칙 10 Bounded range search on indexed columns` : 인덱스가 생성되어있는 칼럼의 범위를 한정하는 형태로 검색하면 속도가 향상된다. 이러한 연산자에는  `BETWEEN`, `LIKE` 등이 있다.
    -  해당 SQL문에서 이용 가능한 인덱스가 존재한다면 전체 테이블 액세스 방식보다는 항상 `인덱스를 사용하는 실행계획`을 생성한다.
    -  조인 순서를 결정할 때는 `조인 칼럼 인덱스의 존재 유무`가 중요한 판단의 기준이다.
        - 조인 칼럼에 대한 인덱스가 양쪽 테이블에 모두 존재한다면 앞에서 설명한 규칙에 따라 우선 순위가 높은 테이블을 선행 테이블(Driving Table)로 선택한다.
        - 한쪽 조인 칼럼에만 인덱스가 존재하는 경우에는 인덱스가 없는 테이블을 선행 테이블로 선택해서 조인을 수행한다.
        - 조인 칼럼에 모두 인덱스가 존재하지 않으면 FROM 절의 뒤에 나열된 테이블을 선행 테이블로 선택한다.
        - 만약 조인 테이블의 우선 순위가 동일하다면 FROM 절에 나열된 테이블의 역순으로 선행 테이블을 선택한다.
        - 양쪽 조인 칼럼에 모두 인덱스가 없는 경우에는 Sort Merge Join을 사용하고 둘 중하나라도 조인 칼럼에 인덱스가 존재한다면 일반적으로 NL Join을 사용한다.

2. 비용기반 옵티마이저
- 칙기반 옵티마이저는 조건절에서 ‘=’ 연산자와 'BETWEEN' 연산자가 사용되면 규칙에 따라 ‘=’ 칼럼의 인덱스를 사용하는 것이 보다 적은 일량 즉, 보다 적은 처리 범위로 작업을 할 것이라고 판단한다.
<br/>그러나 실제로는 ‘BETWEEN’ 칼럼을 사용한 인덱스가 보다 일량이 적을 수 있다.
